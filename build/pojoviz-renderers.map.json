{"version":3,"file":"bundle.js","sources":["/Users/mauricio/Documents/web/maurizzzio.me/pojoviz/node_modules/browserify/node_modules/browser-pack/_prelude.js","/Users/mauricio/Documents/web/maurizzzio.me/pojoviz/src/renderer/index.js","/Users/mauricio/Documents/web/maurizzzio.me/pojoviz/src/renderer/three/index.js","/Users/mauricio/Documents/web/maurizzzio.me/pojoviz/src/renderer/d3/index.js","/Users/mauricio/Documents/web/maurizzzio.me/pojoviz/src/renderer/three/PanControls.js","/Users/mauricio/Documents/web/maurizzzio.me/pojoviz/src/renderer/d3/Canvas.js","/Users/mauricio/Documents/web/maurizzzio.me/pojoviz/src/util/index.js","/Users/mauricio/Documents/web/maurizzzio.me/pojoviz/src/renderer/d3/Node.js","/Users/mauricio/Documents/web/maurizzzio.me/pojoviz/src/util/hashKey.js","/Users/mauricio/Documents/web/maurizzzio.me/pojoviz/src/renderer/d3/Property.js"],"names":["module","exports","d3","require","three","global","pojoviz","addRenderers","t3","window","_","THREE","id","instance","clean","el","document","getElementById","firstChild","removeChild","style","display","loopManager","stop","render","data","getY","node","i","y","height","properties","length","getX","x","width","margin","left","createCameraControls","camera","domElement","cameraControls","PanControls","drawProperties","group","canvas","createElement","context","getContext","font","fillStyle","fillText","label","match","replace","top","forEach","property","type","defaultColor","name","titleHeight","texture","Texture","needsUpdate","material","MeshBasicMaterial","map","side","DoubleSide","transparent","mesh","Mesh","PlaneGeometry","position","set","add","drawNodes","me","this","nodeGroup","Object3D","Geometry","nodes","points","push","Vector2","shape","Shape","createPointsGeometry","geometry","ShapeGeometry","LineBasicMaterial","color","lineWidth","userData","activeScene","nodeMeshes","drawCircles","circleMesh","CircleGeometry","meshes","object","borderStyle","function","updateMatrix","merge","matrix","generateSpline","f","mid","t","index","mult","bumpZ","z","fm","Vector3","addVectors","multiplyScalar","mt","spline","Spline","l","colors","getPoint","vertices","Color","setHSL","drawEdges","fromV","toV","edges","link","from","nodeMap","to","findIndex","d","distanceTo","setZ","opacity","linewidth","vertexColors","VertexColors","Line","number","string","boolean","undefined","projector","Projector","wrapperEl","themes","allWhite","clearColor","fogColor","groundColor","wrapper","bbox","getBoundingClientRect","run","theme","ambientConfig","ground","axes","gridY","gridX","gridZ","init","rendererEl","renderer","datgui","close","fog","sortObjects","shadowMapEnabled","shadowMapType","PCFShadowMap","mouse","moved","down","addEventListener","cursor","e","preventDefault","cx","clientX","cy","clientY","clientWidth","clientHeight","vector","unprojectVector","activeCamera","raycaster","Raycaster","sub","normalize","intersects","intersectObjects","iObject","dest","TWEEN","Tween","easing","Easing","Cubic","InOut","start","target","fov","ratio","near","far","PerspectiveCamera","center","Math","min","mx","mn","addCamera","setActiveCamera","noKeys","call","update","delta","ac","Canvas","destroy","getAutoRotationAngle","PI","scope","autoRotateSpeed","getZoomScale","pow","zoomSpeed","onMouseDown","event","enabled","button","noRotate","state","STATE","ROTATE","rotateStart","noZoom","DOLLY","dollyStart","noPan","PAN","panStart","onMouseMove","onMouseUp","dispatchEvent","startEvent","element","body","rotateEnd","rotateDelta","subVectors","rotateLeft","rotateSpeed","rotateUp","copy","dollyEnd","dollyDelta","dollyIn","dollyOut","panEnd","panDelta","pan","removeEventListener","endEvent","NONE","onMouseWheel","stopPropagation","wheelDelta","detail","onKeyDown","keyCode","keys","UP","keyPanSpeed","BOTTOM","LEFT","RIGHT","touchstart","touches","TOUCH_ROTATE","pageX","pageY","TOUCH_DOLLY","dx","dy","distance","sqrt","TOUCH_PAN","touchmove","touchend","minDistance","maxDistance","Infinity","autoRotate","minPolarAngle","maxPolarAngle","EPS","panOffset","offset","phiDelta","thetaDelta","scale","lastPosition","lastQuaternion","Quaternion","target0","clone","position0","quat","setFromUnitVectors","up","quatInverse","inverse","changeEvent","angle","panLeft","te","elements","panUp","deltaX","deltaY","targetDistance","tan","right","bottom","console","warn","dollyScale","applyQuaternion","theta","atan2","phi","max","radius","sin","cos","lookAt","distanceToSquared","dot","quaternion","reset","prototype","Object","create","EventDispatcher","uniqueId","createRoot","utils","pojoVizNode","svg","select","prefix","prefixer","escapeCls","transformProperty","attr","selectAll","remove","root","append","obj","fixZoom","redraw","translation","translate","newX","newY","transform","zoomBehavior","classed","scr","getBBox","screenWidth","screenHeight","canvasWidth","canvasHeight","sx","sy","isFinite","zoom","behavior","on","transition","duration","renderNodes","renderEdges","mouseEvent","over","diagonal","source","fromData","datum","propertyData","toData","projection","enter","join","opacityToggle","decrease","nodeCtor","propertiesTransformation","[[Prototype]]","assert","v","message","s","forOwn","k","apply","args","slice","arguments","unshift","hasOwnProperty","toQueryString","createEvent","eventName","details","CustomEvent","notification","consoleToo","ev","log","createJsonpCallback","url","script","src","head","appendChild","Node","parent","my","selection","groupMouseBehavior","labelEscaped","predecessors","successors","nodeEnter","text","bodyEnter","propertyCtor","pojoVizProperty","p","each","rect","m","hashKey","isObjectOrFunction","get","hiddenKey","key","defineProperty","value","uid","createHashKeysFor","err","localToString","toString","hasAClassName","getName","className","constructor","has","Property","propertyY","propertyEnter","insert","parentNode"],"mappings":"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","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error(\"Cannot find module '\"+o+\"'\")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","module.exports = {\n  d3: require('./d3/'),\n  three: require('./three/')\n};\n\n// it's not a standalone package\n// but it extends pojoviz's functionality\nglobal.pojoviz.addRenderers(module.exports);","require('./PanControls');\n\nvar t3 = (typeof window !== \"undefined\" ? window.t3 : typeof global !== \"undefined\" ? global.t3 : null),\n  _ = require('lodash'),\n  THREE = (typeof window !== \"undefined\" ? window.THREE : typeof global !== \"undefined\" ? global.THREE : null),\n  id = 'threejscanvas',\n  instance;\n\nmodule.exports = {\n  clean: function () {\n    var el = document.getElementById(id);\n    while(el.firstChild) {\n      el.removeChild(el.firstChild);\n    }\n    el.style.display = 'none';\n    if (instance) {\n      instance.loopManager.stop();\n    }\n  },\n  render: function (data) {\n    var nodes = data.nodes,\n      edges = data.edges,\n      nodeMap = {},\n      margin = {\n        top: 10,\n        left: 10\n      },\n      fillStyle = {\n        number: '#673ab7',\n        'string': '#ff9800',\n        'boolean': '#259b24',\n        'undefined': '#000000'\n      },\n      borderStyle = {\n        object: '#03a9f4',\n        'function': '#e51c23'\n      },\n      defaultColor = '#000000',\n      titleHeight = 40,\n      projector = new THREE.Projector(),\n      nodeMeshes = [];\n\n    nodes.forEach(function (node) {\n      nodeMap[node.label] = node;\n    });\n\n    var wrapperEl = document.getElementById(id);\n    wrapperEl.style.display = 'block';\n\n    // pre init\n    t3.themes.allWhite = {\n      clearColor: 0xffffff,\n      fogColor: 0xffffff,\n      groundColor: 0xffffff\n    };\n    var wrapper = document.getElementById(id),\n      bbox = wrapper.getBoundingClientRect();\n\n    function getY(node, i) {\n      return node.y - node.height * 0.5 +\n        (node.properties.length - i) * 15;\n    }\n\n    function getX(node) {\n      return node.x - node.width * 0.5 + margin.left;\n    }\n\n    function createCameraControls(camera, domElement) {\n      camera.cameraControls = new THREE.PanControls(camera, domElement);\n    }\n\n    function createTextSprites() {\n      var shapes = THREE.FontUtils.generateShapes(\"Hello world\", {\n        font: \"helvetiker\",\n        weight: \"bold\",\n        size: 10\n      });\n      var geom = new THREE.ShapeGeometry(shapes);\n      var mat = new THREE.MeshBasicMaterial();\n      return new THREE.Mesh(geom, mat);\n    }\n\n    function drawProperties(node, group) {\n      var canvas = document.createElement('canvas');\n      canvas.width = node.width;\n      canvas.height = node.height;\n      var context = canvas.getContext('2d');\n      context.font = \"normal 100 18px Roboto\";\n      context.fillStyle = \"rgba(0, 0, 0, 1)\";\n      context.fillText(\n        node.label\n          .match(/^\\S*?-([\\S-]*)$/)[1]\n          .replace(/-/, '.'),\n        margin.left,\n        margin.top + 15\n      );\n\n      node.properties.forEach(function (property, i) {\n        var sphere;\n\n        // draw text on the canvas\n        context.font = \"normal 15px Arial\";\n        context.fillStyle = fillStyle[property.type] || defaultColor;\n        context.fillText(\n          property.name,\n          margin.left * 2,\n          margin.top + titleHeight + i * 15\n        );\n      });\n\n      var texture = new THREE.Texture(canvas);\n      texture.needsUpdate = true;\n\n      var material = new THREE.MeshBasicMaterial({\n        map: texture,\n        side:THREE.DoubleSide\n      });\n      material.transparent = true;\n      var mesh = new THREE.Mesh(\n          new THREE.PlaneGeometry(canvas.width, canvas.height),\n          material\n      );\n      // mesh.position.x += node.width / 2;\n      // mesh.position.y += node.height / 2;\n\n      mesh.position.set(\n        node.x,\n        node.y,\n        0.1\n      );\n\n      group.add(mesh);\n    }\n\n    function drawNodes() {\n      var me = this,\n        nodeGroup = new THREE.Object3D(),\n        nodeGeometry = new THREE.Geometry();\n\n      nodes.forEach(function (node) {\n        var points = [],\n         g = new THREE.Object3D();\n        points.push(new THREE.Vector2(0, 0));\n        points.push(new THREE.Vector2(node.width, 0));\n        points.push(new THREE.Vector2(node.width, node.height));\n        points.push(new THREE.Vector2(0, node.height));\n\n        var shape = new THREE.Shape(points);\n        points = shape.createPointsGeometry();\n\n        var type = node.label\n          .match(/^(\\S*?)-/)[1];\n        var geometry = new THREE.ShapeGeometry(shape);\n        var mesh = new THREE.Mesh(\n          geometry,\n          new THREE.LineBasicMaterial({\n            color: '#eeeeee',// borderStyle['function'],\n            lineWidth: 1\n          })\n        );\n\n        mesh.userData.node = node;\n        mesh.position.set(\n          node.x - node.width * 0.5,\n          node.y - node.height * 0.5,\n          0\n        );\n\n        // EACH ONE IS A SINGLE MESH\n        me.activeScene.add(mesh);\n        nodeMeshes.push(mesh);\n\n        // MERGE\n        // mesh.updateMatrix();\n        // nodeGeometry.merge(mesh.geometry, mesh.matrix);\n\n        // add the description in another group\n        drawProperties(node, nodeGroup);\n      });\n\n      me.activeScene.add(nodeGroup);\n\n      // MERGE\n      // me.activeScene.add(new THREE.Mesh(\n      //   nodeGeometry,\n      //   new THREE.LineBasicMaterial({\n      //     color: '#eeeeee',// borderStyle['function'],\n      //     lineWidth: 1\n      //   })\n      // ));\n    }\n\n    function drawCircles() {\n      var me = this,\n        circleMesh = new THREE.Mesh(new THREE.CircleGeometry(5, 8)),\n        meshes = {\n          object: {\n            material: new THREE.MeshBasicMaterial({\n              color: borderStyle.object\n            }),\n            geometry: new THREE.Geometry()\n          },\n          'function': {\n            material: new THREE.MeshBasicMaterial({\n              color: borderStyle['function']\n            }),\n            geometry: new THREE.Geometry()\n          }\n        };\n      nodes.forEach(function (node) {\n        node.properties.forEach(function (property, i) {\n          var geometry;\n          if (property.type === 'function' || property.type === 'object') {\n            circleMesh.position.set(\n              getX(node), getY(node, i) + 5, 0.2\n            );\n            circleMesh.updateMatrix();\n            meshes[property.type].geometry\n              .merge(circleMesh.geometry, circleMesh.matrix);\n          }\n        });\n      });\n      me.activeScene.add(new THREE.Mesh(\n        meshes.object.geometry, meshes.object.material\n      ));\n      me.activeScene.add(new THREE.Mesh(\n        meshes['function'].geometry, meshes['function'].material\n      ));\n    }\n\n    function generateSpline(f, mid, t, d) {\n      var mult = 0,\n        bumpZ = mid.z * 0.2,\n        fm = new THREE.Vector3()\n          .addVectors(f, mid)\n          .multiplyScalar(0.5)\n          .add(new THREE.Vector3(\n            (mid.x - f.x) * mult,\n            (f.y - mid.y) * mult,\n            bumpZ\n          )),\n        mt = new THREE.Vector3()\n          .addVectors(mid, t)\n          .multiplyScalar(0.5)\n          .add(new THREE.Vector3(\n            (mid.x - t.x) * mult,\n            (t.y - mid.y) * mult,\n            bumpZ\n          ));\n\n      var spline = new THREE.Spline([\n        f, fm, mid, mt, t\n      ]), i, l = 10, index, position,\n        geometry = new THREE.Geometry();\n\n      geometry.colors = [];\n      for (i = 0; i <= l; i += 1) {\n        index = i / l;\n        position = spline.getPoint(index);\n        geometry.vertices[i] = new THREE.Vector3(position.x, position.y, position.z);\n        geometry.colors[i] = new THREE.Color(0xffffff);\n        geometry.colors[i].setHSL(\n          // 200 / 360,\n          // index,\n          // 0.5\n          200/360,\n          1,\n          0.9\n        );\n      }\n      return geometry;\n    }\n\n    function drawEdges(scope) {\n      var me = this,\n        fromV = new THREE.Vector3(),\n        toV = new THREE.Vector3(),\n        mid = new THREE.Vector3();\n\n      edges.forEach(function (link, i) {\n        // console.log(i, edges.length);\n        var from = nodeMap[link.from];\n        var to = nodeMap[link.to];\n\n        var index = _.findIndex(\n          from.properties,\n          { name: link.property }\n        );\n        fromV.set(\n          from.x - from.width * 0.5 + margin.left,\n          from.y - from.height * 0.5 + (from.properties.length - index) * 15 + 5,\n          0\n        );\n        toV.set(\n          to.x - to.width * 0.5,\n          to.y - to.height * 0.5,\n          0\n        );\n        var d = fromV.distanceTo(toV);\n        mid\n          .addVectors(fromV, toV)\n          .multiplyScalar(0.5)\n          .setZ(50);\n\n        var geometry = generateSpline(fromV, mid, toV, d);\n        var material = new THREE.LineBasicMaterial({\n          color: 0xffffff,\n          opacity: 0.5,\n          linewidth: 3,\n          vertexColors: THREE.VertexColors\n        });\n        var mesh = new THREE.Line(geometry, material);\n        me.activeScene.add(mesh);\n      });\n    }\n\n    instance = t3.run({\n      id: id,\n      width: bbox.width,\n      height: bbox.height,\n      theme: 'allWhite',\n      ambientConfig: {\n        ground: false,\n        axes: false,\n        gridY: false,\n        gridX: false,\n        gridZ: false\n      },\n      init: function () {\n        var me = this,\n          rendererEl = me.renderer.domElement;\n        me.datgui.close();\n        me.activeScene.fog = null;\n        me.renderer.sortObjects = false;\n        me.renderer.shadowMapEnabled = true;\n        me.renderer.shadowMapType = THREE.PCFShadowMap;\n\n        var mouse = new THREE.Vector3();\n        var oldIntersected = null;\n        var moved = false, down = false;\n        rendererEl.addEventListener('mousemove', function (e) {\n          if (down) {\n            moved = true;\n            wrapperEl.style.cursor = 'move';\n          } else {\n            moved = false;\n          }\n        });\n        rendererEl.addEventListener('mouseout', function (e) {\n\n        });\n        rendererEl.addEventListener('mousedown', function (e) {\n          down = true;\n        });\n        rendererEl.addEventListener('mouseup', function (e) {\n          down = false;\n          wrapperEl.style.cursor = 'auto';\n        });\n        rendererEl.addEventListener('click', function (e) {\n          e.preventDefault();\n          var bbox = rendererEl.getBoundingClientRect();\n          var cx = e.clientX - bbox.left;\n          var cy = e.clientY - bbox.top;\n          var tween;\n          mouse.x = (cx / rendererEl.clientWidth) * 2 - 1;\n          mouse.y = -(cy / rendererEl.clientHeight) * 2 + 1;\n          var vector = new THREE.Vector3( mouse.x, mouse.y, 0.5 );\n          projector.unprojectVector(vector, me.activeCamera);\n\n          var raycaster = new THREE.Raycaster(\n            camera.position,\n            vector.sub(camera.position).normalize()\n          );\n          var intersects = raycaster.intersectObjects(nodeMeshes),\n            iObject = intersects[0] && intersects[0].object;\n          if (iObject && !moved) {\n            // focus on this object on click\n            // console.log(iObject);\n            var dest = {\n              x: iObject.position.x + iObject.userData.node.width / 2,\n              y: iObject.position.y + iObject.userData.node.height / 2\n            };\n            new TWEEN.Tween(me.activeCamera.position)\n              .to(_.merge({}, dest, {\n                z: iObject.userData.node.height\n              }), 1000)\n              .easing(TWEEN.Easing.Cubic.InOut)\n              .start();\n            new TWEEN.Tween(me.activeCamera.cameraControls.target)\n              .to(dest, 1000)\n              .easing(TWEEN.Easing.Cubic.InOut)\n              .start();\n          }\n        }, false);\n\n        // camera\n        var fov = 70,\n          ratio = rendererEl.clientWidth /\n            rendererEl.clientHeight,\n          near = 1,\n          far = 20000;\n        var camera = new THREE.PerspectiveCamera(fov, ratio, near, far);\n        camera.position.set(\n          data.center.x,\n          data.center.y,\n          Math.min(data.mx.x - data.mn.x, data.mx.y - data.mn.y)\n        );\n        // camera.lookAt(new THREE.Vector3(data.center.x, data.center.y, 0));\n        me\n          .addCamera(camera, 'mine')\n          .setActiveCamera('mine');\n        createCameraControls(camera, rendererEl);\n        camera.cameraControls.target.set(\n          data.center.x,\n          data.center.y,\n          0\n        );\n        camera.cameraControls.noKeys = true;\n\n        // draw the nodes\n        drawNodes.call(me);\n        drawCircles.call(me);\n        drawEdges.call(me);\n      },\n      update: function (delta) {\n        TWEEN.update();\n        var me = this;\n        me.ac = me.ac || 0;\n        me.ac += delta;\n        if (me.ac > 2) {\n          // console.log(me.renderer.info.render);\n          // console.log(me.renderer);\n          me.ac = 0;\n        }\n      }\n    });\n  }\n};","var Canvas = require('./Canvas'),\n  canvas;\n\nmodule.exports = {\n  clean: function () {\n    if (canvas) {\n      canvas.destroy();\n    }\n  },\n  render: function (data) {\n    canvas = new Canvas(data);\n    canvas.render();\n  }\n};","/**\n * @author qiao / https://github.com/qiao\n * @author mrdoob / http://mrdoob.com\n * @author alteredq / http://alteredqualia.com/\n * @author WestLangley / http://github.com/WestLangley\n * @author erich666 / http://erichaines.com\n */\n/*global THREE, console */\n\n// This set of controls performs orbiting, dollying (zooming), and panning. It maintains\n// the \"up\" direction as +Y, unlike the TrackballControls. Touch on tablet and phones is\n// supported.\n//\n//    Orbit - left mouse / touch: one finger move\n//    Zoom - middle mouse, or mousewheel / touch: two finger spread or squish\n//    Pan - right mouse, or arrow keys / touch: three finter swipe\n//\n// This is a drop-in replacement for (most) TrackballControls used in examples.\n// That is, include this js file and wherever you see:\n//      controls = new THREE.TrackballControls( camera );\n//      controls.target.z = 150;\n// Simple substitute \"PanControls\" and the control should work as-is.\n\nTHREE.PanControls = function ( object, domElement ) {\n\n\tthis.object = object;\n\tthis.domElement = ( domElement !== undefined ) ? domElement : document;\n\n\t// API\n\n\t// Set to false to disable this control\n\tthis.enabled = true;\n\n\t// \"target\" sets the location of focus, where the control orbits around\n\t// and where it pans with respect to.\n\tthis.target = new THREE.Vector3();\n\n\t// center is old, deprecated; use \"target\" instead\n\tthis.center = this.target;\n\n\t// This option actually enables dollying in and out; left as \"zoom\" for\n\t// backwards compatibility\n\tthis.noZoom = false;\n\tthis.zoomSpeed = 1.0;\n\n\t// Limits to how far you can dolly in and out\n\tthis.minDistance = 0;\n\tthis.maxDistance = Infinity;\n\n\t// Set to true to disable this control\n\tthis.noRotate = false;\n\tthis.rotateSpeed = 1.0;\n\n\t// Set to true to disable this control\n\tthis.noPan = false;\n\tthis.keyPanSpeed = 7.0;\t// pixels moved per arrow key push\n\n\t// Set to true to automatically rotate around the target\n\tthis.autoRotate = false;\n\tthis.autoRotateSpeed = 2.0; // 30 seconds per round when fps is 60\n\n\t// How far you can orbit vertically, upper and lower limits.\n\t// Range is 0 to Math.PI radians.\n\tthis.minPolarAngle = 0; // radians\n\tthis.maxPolarAngle = Math.PI; // radians\n\n\t// Set to true to disable use of the keys\n\tthis.noKeys = false;\n\n\t// The four arrow keys\n\tthis.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40 };\n\n\t////////////\n\t// internals\n\n\tvar scope = this;\n\n\tvar EPS = 0.000001;\n\n\tvar rotateStart = new THREE.Vector2();\n\tvar rotateEnd = new THREE.Vector2();\n\tvar rotateDelta = new THREE.Vector2();\n\n\tvar panStart = new THREE.Vector2();\n\tvar panEnd = new THREE.Vector2();\n\tvar panDelta = new THREE.Vector2();\n\tvar panOffset = new THREE.Vector3();\n\n\tvar offset = new THREE.Vector3();\n\n\tvar dollyStart = new THREE.Vector2();\n\tvar dollyEnd = new THREE.Vector2();\n\tvar dollyDelta = new THREE.Vector2();\n\n\tvar phiDelta = 0;\n\tvar thetaDelta = 0;\n\tvar scale = 1;\n\tvar pan = new THREE.Vector3();\n\n\tvar lastPosition = new THREE.Vector3();\n\tvar lastQuaternion = new THREE.Quaternion();\n\n\tvar STATE = { NONE : -1, ROTATE : 0, DOLLY : 1, PAN : 2, TOUCH_ROTATE : 3, TOUCH_DOLLY : 4, TOUCH_PAN : 5 };\n\n\tvar state = STATE.NONE;\n\n\t// for reset\n\n\tthis.target0 = this.target.clone();\n\tthis.position0 = this.object.position.clone();\n\n\t// so camera.up is the orbit axis\n\n\tvar quat = new THREE.Quaternion().setFromUnitVectors( object.up, new THREE.Vector3( 0, 1, 0 ) );\n\tvar quatInverse = quat.clone().inverse();\n\n\t// events\n\n\tvar changeEvent = { type: 'change' };\n\tvar startEvent = { type: 'start'};\n\tvar endEvent = { type: 'end'};\n\n\tthis.rotateLeft = function ( angle ) {\n\n\t\tif ( angle === undefined ) {\n\n\t\t\tangle = getAutoRotationAngle();\n\n\t\t}\n\n\t\tthetaDelta -= angle;\n\n\t};\n\n\tthis.rotateUp = function ( angle ) {\n\n\t\tif ( angle === undefined ) {\n\n\t\t\tangle = getAutoRotationAngle();\n\n\t\t}\n\n\t\tphiDelta -= angle;\n\n\t};\n\n\t// pass in distance in world space to move left\n\tthis.panLeft = function ( distance ) {\n\n\t\tvar te = this.object.matrix.elements;\n\n\t\t// get X column of matrix\n\t\tpanOffset.set( te[ 0 ], te[ 1 ], te[ 2 ] );\n\t\tpanOffset.multiplyScalar( - distance );\n\n\t\tpan.add( panOffset );\n\n\t};\n\n\t// pass in distance in world space to move up\n\tthis.panUp = function ( distance ) {\n\n\t\tvar te = this.object.matrix.elements;\n\n\t\t// get Y column of matrix\n\t\tpanOffset.set( te[ 4 ], te[ 5 ], te[ 6 ] );\n\t\tpanOffset.multiplyScalar( distance );\n\n\t\tpan.add( panOffset );\n\n\t};\n\n\t// pass in x,y of change desired in pixel space,\n\t// right and down are positive\n\tthis.pan = function ( deltaX, deltaY ) {\n\n\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n\t\tif ( scope.object.fov !== undefined ) {\n\n\t\t\t// perspective\n\t\t\tvar position = scope.object.position;\n\t\t\tvar offset = position.clone().sub( scope.target );\n\t\t\tvar targetDistance = offset.length();\n\n\t\t\t// half of the fov is center to top of screen\n\t\t\ttargetDistance *= Math.tan( ( scope.object.fov / 2 ) * Math.PI / 180.0 );\n\n\t\t\t// we actually don't use screenWidth, since perspective camera is fixed to screen height\n\t\t\tscope.panLeft( 2 * deltaX * targetDistance / element.clientHeight );\n\t\t\tscope.panUp( 2 * deltaY * targetDistance / element.clientHeight );\n\n\t\t} else if ( scope.object.top !== undefined ) {\n\n\t\t\t// orthographic\n\t\t\tscope.panLeft( deltaX * (scope.object.right - scope.object.left) / element.clientWidth );\n\t\t\tscope.panUp( deltaY * (scope.object.top - scope.object.bottom) / element.clientHeight );\n\n\t\t} else {\n\n\t\t\t// camera neither orthographic or perspective\n\t\t\tconsole.warn( 'WARNING: PanControls.js encountered an unknown camera type - pan disabled.' );\n\n\t\t}\n\n\t};\n\n\tthis.dollyIn = function ( dollyScale ) {\n\n\t\tif ( dollyScale === undefined ) {\n\n\t\t\tdollyScale = getZoomScale();\n\n\t\t}\n\n\t\tscale /= dollyScale;\n\n\t};\n\n\tthis.dollyOut = function ( dollyScale ) {\n\n\t\tif ( dollyScale === undefined ) {\n\n\t\t\tdollyScale = getZoomScale();\n\n\t\t}\n\n\t\tscale *= dollyScale;\n\n\t};\n\n\tthis.update = function () {\n\n\t\tvar position = this.object.position;\n\n\t\toffset.copy( position ).sub( this.target );\n\n\t\t// rotate offset to \"y-axis-is-up\" space\n\t\toffset.applyQuaternion( quat );\n\n\t\t// angle from z-axis around y-axis\n\n\t\tvar theta = Math.atan2( offset.x, offset.z );\n\n\t\t// angle from y-axis\n\n\t\tvar phi = Math.atan2( Math.sqrt( offset.x * offset.x + offset.z * offset.z ), offset.y );\n\n\t\tif ( this.autoRotate ) {\n\n\t\t\tthis.rotateLeft( getAutoRotationAngle() );\n\n\t\t}\n\n\t\ttheta += thetaDelta;\n\t\tphi += phiDelta;\n\n\t\t// restrict phi to be between desired limits\n\t\tphi = Math.max( this.minPolarAngle, Math.min( this.maxPolarAngle, phi ) );\n\n\t\t// restrict phi to be betwee EPS and PI-EPS\n\t\tphi = Math.max( EPS, Math.min( Math.PI - EPS, phi ) );\n\n\t\tvar radius = offset.length() * scale;\n\n\t\t// restrict radius to be between desired limits\n\t\tradius = Math.max( this.minDistance, Math.min( this.maxDistance, radius ) );\n\n\t\t// move target to panned location\n\t\tthis.target.add( pan );\n\n\t\toffset.x = radius * Math.sin( phi ) * Math.sin( theta );\n\t\toffset.y = radius * Math.cos( phi );\n\t\toffset.z = radius * Math.sin( phi ) * Math.cos( theta );\n\n\t\t// rotate offset back to \"camera-up-vector-is-up\" space\n\t\toffset.applyQuaternion( quatInverse );\n\n\t\tposition.copy( this.target ).add( offset );\n\n\t\tthis.object.lookAt( this.target );\n\n\t\tthetaDelta = 0;\n\t\tphiDelta = 0;\n\t\tscale = 1;\n\t\tpan.set( 0, 0, 0 );\n\n\t\t// update condition is:\n\t\t// min(camera displacement, camera rotation in radians)^2 > EPS\n\t\t// using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\n\t\tif ( lastPosition.distanceToSquared( this.object.position ) > EPS\n\t\t    || 8 * (1 - lastQuaternion.dot(this.object.quaternion)) > EPS ) {\n\n\t\t\tthis.dispatchEvent( changeEvent );\n\n\t\t\tlastPosition.copy( this.object.position );\n\t\t\tlastQuaternion.copy (this.object.quaternion );\n\n\t\t}\n\n\t};\n\n\n\tthis.reset = function () {\n\n\t\tstate = STATE.NONE;\n\n\t\tthis.target.copy( this.target0 );\n\t\tthis.object.position.copy( this.position0 );\n\n\t\tthis.update();\n\n\t};\n\n\tfunction getAutoRotationAngle() {\n\n\t\treturn 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\n\n\t}\n\n\tfunction getZoomScale() {\n\n\t\treturn Math.pow( 0.95, scope.zoomSpeed );\n\n\t}\n\n\tfunction onMouseDown( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\t\tevent.preventDefault();\n\n\t\tif ( event.button === 2 ) {\n\t\t\tif ( scope.noRotate === true ) return;\n\n\t\t\tstate = STATE.ROTATE;\n\n\t\t\trotateStart.set( event.clientX, event.clientY );\n\n\t\t} else if ( event.button === 1 ) {\n\t\t\tif ( scope.noZoom === true ) return;\n\n\t\t\tstate = STATE.DOLLY;\n\n\t\t\tdollyStart.set( event.clientX, event.clientY );\n\n\t\t} else if ( event.button === 0 ) {\n\t\t\tif ( scope.noPan === true ) return;\n\n\t\t\tstate = STATE.PAN;\n\n\t\t\tpanStart.set( event.clientX, event.clientY );\n\n\t\t}\n\n\t\tdocument.addEventListener( 'mousemove', onMouseMove, false );\n\t\tdocument.addEventListener( 'mouseup', onMouseUp, false );\n\t\tscope.dispatchEvent( startEvent );\n\n\t}\n\n\tfunction onMouseMove( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n\t\tif ( state === STATE.ROTATE ) {\n\n\t\t\tif ( scope.noRotate === true ) return;\n\n\t\t\trotateEnd.set( event.clientX, event.clientY );\n\t\t\trotateDelta.subVectors( rotateEnd, rotateStart );\n\n\t\t\t// rotating across whole screen goes 360 degrees around\n\t\t\tscope.rotateLeft( 2 * Math.PI * rotateDelta.x / element.clientWidth * scope.rotateSpeed );\n\n\t\t\t// rotating up and down along whole screen attempts to go 360, but limited to 180\n\t\t\tscope.rotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight * scope.rotateSpeed );\n\n\t\t\trotateStart.copy( rotateEnd );\n\n\t\t} else if ( state === STATE.DOLLY ) {\n\n\t\t\tif ( scope.noZoom === true ) return;\n\n\t\t\tdollyEnd.set( event.clientX, event.clientY );\n\t\t\tdollyDelta.subVectors( dollyEnd, dollyStart );\n\n\t\t\tif ( dollyDelta.y > 0 ) {\n\n\t\t\t\tscope.dollyIn();\n\n\t\t\t} else {\n\n\t\t\t\tscope.dollyOut();\n\n\t\t\t}\n\n\t\t\tdollyStart.copy( dollyEnd );\n\n\t\t} else if ( state === STATE.PAN ) {\n\n\t\t\tif ( scope.noPan === true ) return;\n\n\t\t\tpanEnd.set( event.clientX, event.clientY );\n\t\t\tpanDelta.subVectors( panEnd, panStart );\n\n\t\t\tscope.pan( panDelta.x, panDelta.y );\n\n\t\t\tpanStart.copy( panEnd );\n\n\t\t}\n\n\t\tscope.update();\n\n\t}\n\n\tfunction onMouseUp( /* event */ ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tdocument.removeEventListener( 'mousemove', onMouseMove, false );\n\t\tdocument.removeEventListener( 'mouseup', onMouseUp, false );\n\t\tscope.dispatchEvent( endEvent );\n\t\tstate = STATE.NONE;\n\n\t}\n\n\tfunction onMouseWheel( event ) {\n\n\t\tif ( scope.enabled === false || scope.noZoom === true ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tvar delta = 0;\n\n\t\tif ( event.wheelDelta !== undefined ) { // WebKit / Opera / Explorer 9\n\n\t\t\tdelta = event.wheelDelta;\n\n\t\t} else if ( event.detail !== undefined ) { // Firefox\n\n\t\t\tdelta = - event.detail;\n\n\t\t}\n\n\t\tif ( delta > 0 ) {\n\n\t\t\tscope.dollyOut();\n\n\t\t} else {\n\n\t\t\tscope.dollyIn();\n\n\t\t}\n\n\t\tscope.update();\n\t\tscope.dispatchEvent( startEvent );\n\t\tscope.dispatchEvent( endEvent );\n\n\t}\n\n\tfunction onKeyDown( event ) {\n\n\t\tif ( scope.enabled === false || scope.noKeys === true || scope.noPan === true ) return;\n\n\t\tswitch ( event.keyCode ) {\n\n\t\t\tcase scope.keys.UP:\n\t\t\t\tscope.pan( 0, scope.keyPanSpeed );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.BOTTOM:\n\t\t\t\tscope.pan( 0, - scope.keyPanSpeed );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.LEFT:\n\t\t\t\tscope.pan( scope.keyPanSpeed, 0 );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.RIGHT:\n\t\t\t\tscope.pan( - scope.keyPanSpeed, 0 );\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\tfunction touchstart( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tswitch ( event.touches.length ) {\n\n\t\t\tcase 1:\t// one-fingered touch: rotate\n\n\t\t\t\tif ( scope.noRotate === true ) return;\n\n\t\t\t\tstate = STATE.TOUCH_ROTATE;\n\n\t\t\t\trotateStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\t\t\t\tbreak;\n\n\t\t\tcase 2:\t// two-fingered touch: dolly\n\n\t\t\t\tif ( scope.noZoom === true ) return;\n\n\t\t\t\tstate = STATE.TOUCH_DOLLY;\n\n\t\t\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\t\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\t\t\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\n\t\t\t\tdollyStart.set( 0, distance );\n\t\t\t\tbreak;\n\n\t\t\tcase 3: // three-fingered touch: pan\n\n\t\t\t\tif ( scope.noPan === true ) return;\n\n\t\t\t\tstate = STATE.TOUCH_PAN;\n\n\t\t\t\tpanStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t\tscope.dispatchEvent( startEvent );\n\n\t}\n\n\tfunction touchmove( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n\t\tswitch ( event.touches.length ) {\n\n\t\t\tcase 1: // one-fingered touch: rotate\n\n\t\t\t\tif ( scope.noRotate === true ) return;\n\t\t\t\tif ( state !== STATE.TOUCH_ROTATE ) return;\n\n\t\t\t\trotateEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\t\t\t\trotateDelta.subVectors( rotateEnd, rotateStart );\n\n\t\t\t\t// rotating across whole screen goes 360 degrees around\n\t\t\t\tscope.rotateLeft( 2 * Math.PI * rotateDelta.x / element.clientWidth * scope.rotateSpeed );\n\t\t\t\t// rotating up and down along whole screen attempts to go 360, but limited to 180\n\t\t\t\tscope.rotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight * scope.rotateSpeed );\n\n\t\t\t\trotateStart.copy( rotateEnd );\n\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tcase 2: // two-fingered touch: dolly\n\n\t\t\t\tif ( scope.noZoom === true ) return;\n\t\t\t\tif ( state !== STATE.TOUCH_DOLLY ) return;\n\n\t\t\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\t\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\t\t\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\t\t\tdollyEnd.set( 0, distance );\n\t\t\t\tdollyDelta.subVectors( dollyEnd, dollyStart );\n\n\t\t\t\tif ( dollyDelta.y > 0 ) {\n\n\t\t\t\t\tscope.dollyOut();\n\n\t\t\t\t} else {\n\n\t\t\t\t\tscope.dollyIn();\n\n\t\t\t\t}\n\n\t\t\t\tdollyStart.copy( dollyEnd );\n\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tcase 3: // three-fingered touch: pan\n\n\t\t\t\tif ( scope.noPan === true ) return;\n\t\t\t\tif ( state !== STATE.TOUCH_PAN ) return;\n\n\t\t\t\tpanEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\t\t\t\tpanDelta.subVectors( panEnd, panStart );\n\n\t\t\t\tscope.pan( panDelta.x, panDelta.y );\n\n\t\t\t\tpanStart.copy( panEnd );\n\n\t\t\t\tscope.update();\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t}\n\n\tfunction touchend( /* event */ ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tscope.dispatchEvent( endEvent );\n\t\tstate = STATE.NONE;\n\n\t}\n\n\tthis.domElement.addEventListener( 'contextmenu', function ( event ) { event.preventDefault(); }, false );\n\tthis.domElement.addEventListener( 'mousedown', onMouseDown, false );\n\tthis.domElement.addEventListener( 'mousewheel', onMouseWheel, false );\n\tthis.domElement.addEventListener( 'DOMMouseScroll', onMouseWheel, false ); // firefox\n\n\tthis.domElement.addEventListener( 'touchstart', touchstart, false );\n\tthis.domElement.addEventListener( 'touchend', touchend, false );\n\tthis.domElement.addEventListener( 'touchmove', touchmove, false );\n\n\twindow.addEventListener( 'keydown', onKeyDown, false );\n\n\t// force an update at start\n\tthis.update();\n\n};\n\nTHREE.PanControls.prototype = Object.create( THREE.EventDispatcher.prototype );\n","var d3 = (typeof window !== \"undefined\" ? window.d3 : typeof global !== \"undefined\" ? global.d3 : null),\n  _ = require('lodash'),\n  utils = require('../../util/'),\n  pojoVizNode = require('./Node');\n\nvar svg = d3.select('svg#canvas');\nvar prefix = utils.prefixer;\nvar escapeCls = utils.escapeCls;\nvar transformProperty = utils.transformProperty;\n\nfunction getX(d) {\n  return d.x - d.width / 2;\n}\n\nfunction getY(d) {\n  return d.y - d.height / 2;\n}\n\nfunction Canvas(data) {\n  this.id = _.uniqueId();\n  this.data = data;\n  this.createRoot();\n  this.set({\n    nodes: data.nodes,\n    edges: data.edges\n  });\n}\n\nCanvas.prototype.destroy = function() {\n  this.data = null;\n  svg.attr('style', 'display: none');\n  svg\n    .selectAll('*')\n    .remove();\n};\n\nCanvas.prototype.createRoot = function() {\n  svg.attr('style', '');\n  this.root = svg\n    .append('g')\n      .attr('class', 'root-' + this.id);\n};\n\nCanvas.prototype.set = function(obj, render) {\n  this.nodes = obj.nodes;\n  this.edges = obj.edges;\n  if (render) {\n    this.render();\n  }\n};\n\nCanvas.prototype.fixZoom = function() {\n  var me = this,\n      scr = svg.node(),\n      bbox = this.root.node().getBBox(),\n      screenWidth = scr.clientWidth,\n      screenHeight = scr.clientHeight,\n      canvasWidth = bbox.width,\n      canvasHeight = bbox.height,\n      sx = this.data.mn.x,\n      sy = this.data.mn.y,\n      scale = Math.min(\n        screenWidth / canvasWidth,\n        screenHeight / canvasHeight\n      ),\n      translate;\n\n  if (!isFinite(scale)) {\n    scale = 0;\n  }\n  // change the scale proportionally to its proximity to zero\n  scale -= scale / 10;\n\n  translate = [\n    -sx * scale + (screenWidth / 2 -\n      canvasWidth * scale / 2),\n    -sy * scale + (screenHeight / 2 -\n      canvasHeight * scale / 2),\n  ];\n\n  function redraw() {\n    var translation = d3.event.translate,\n        newX = translation[0],\n        newY = translation[1];\n    me.root.attr('transform',\n      utils.transform({\n        translate: [newX, newY],\n        scale: [d3.event.scale]\n      })\n    );\n  }\n\n  function zoomBehavior(type) {\n    var start = type === 'start';\n    return function () {\n      d3.select(this).classed('dragged', start);\n    };\n  }\n\n  // console.log('center', translate);\n  // console.log(scr.clientWidth, bbox.width, sx);\n  var zoom = d3.behavior.zoom()\n    .on('zoomstart', zoomBehavior('start'))\n    .on('zoom', redraw)\n    .on('zoomend', zoomBehavior('end'))\n    .translate(translate)\n    .scale(scale);\n\n  svg.call(zoom);\n\n  me.root\n    .attr('transform', utils.transform({\n      scale: [scale],\n      translate: [\n        -sx + (screenWidth / scale / 2 - canvasWidth / 2),\n        -sy + (screenHeight / scale / 2 - canvasHeight / 2)\n      ]\n    }))\n    .attr('opacity', 0)\n    .transition()\n    .duration(500)\n    .attr('opacity', 1);\n};\n\nCanvas.prototype.render = function() {\n  this.renderNodes();\n  this.renderEdges();\n  this.fixZoom();\n};\n\nCanvas.prototype.renderEdges = function() {\n  var me = this,\n      edges = this.edges;\n\n  // CREATE\n  var diagonal = d3.svg.diagonal()\n  .source(function(d) {\n    var from = me.root.select('.' +\n          prefix(escapeCls(d.from))\n        );\n    if (!from.node()) {\n      throw 'source node must exist';\n    }\n    var fromData = from.datum(),\n        property = from.select('.' + prefix(\n          escapeCls(transformProperty(d.property))\n        )),\n        propertyData = d3.transform(property.attr('transform'));\n\n    return {\n      x: getY(fromData) + propertyData.translate[1] - 2,\n      y: getX(fromData) + propertyData.translate[0] - 10\n    };\n  })\n  .target(function(d) {\n    var to = me.root.select('.' +\n          prefix(escapeCls(d.to))\n        ),\n        toData, bbox;\n    if (!to.node()) {\n      throw 'target node must exist';\n    }\n    toData = to.datum();\n    bbox = to.node().getBBox();\n    return {\n      x: getY(toData) + 10,// + bbox.height / 2,\n      y: getX(toData)// + bbox.width / 2\n    };\n  })\n  .projection(function(d) {\n    return [d.y, d.x];\n  });\n\n  function mouseEvent(type) {\n    var over = type === 'over';\n    return function (d) {\n      d3.select(this)\n        .classed('selected', over);\n    };\n  }\n\n  var e = this.root.selectAll('.link')\n      .data(edges)\n    .enter()\n      .append('path')\n      .attr('class', function (d) {\n        return [\n          prefix('to', escapeCls(d.to)),\n          prefix('from', escapeCls(d.from)),\n          prefix('link')\n        ].join(' ');\n      })\n      .attr('stroke', 'lightgray')\n      .attr('stroke-opacity', 0.3)\n      .attr('d', diagonal)\n      .on('mouseover', mouseEvent('over'))\n      .on('mouseout', mouseEvent('out'));\n};\n\nCanvas.prototype.opacityToggle = function(decrease) {\n  this.root\n    .classed(prefix('nodes-focused'), decrease);\n};\n\nCanvas.prototype.renderNodes = function() {\n  var nodes = this.nodes;\n\n  var nodeCtor = pojoVizNode(this);\n  nodeCtor.margin({\n    top: 10,\n    left: 10,\n    right: 10,\n    bottom: 10\n  });\n  var nodeGroup = this.root.selectAll(prefix('node'))\n    .data(nodes)\n    .call(nodeCtor);\n};\n\nmodule.exports = Canvas;","'use strict';\n\nvar _ = require('lodash');\n\nvar propertiesTransformation = {\n  '[[Prototype]]': '__proto__'\n};\n\nvar utils = {\n  assert: function (v, message) {\n    if (!v) {\n      throw message || 'error';\n    }\n  },\n  translate: function (x, y) {\n    return 'translate(' + (x || 0) + ', ' + (y || 0) + ')';\n  },\n  scale: function (s) {\n    return 'scale(' + (s || 1) + ')';\n  },\n  transform: function (obj) {\n    var t = [];\n    _.forOwn(obj, function (v, k) {\n      t.push(utils[k].apply(utils, v));\n    });\n    return t.join(' ');\n  },\n  prefixer: function () {\n    var args = [].slice.call(arguments);\n    args.unshift('pv');\n    return args.join('-');\n  },\n  transformProperty: function (v) {\n    if (propertiesTransformation.hasOwnProperty(v)) {\n      return propertiesTransformation[v];\n    }\n    return v;\n  },\n  escapeCls: function(v) {\n    return v.replace(/\\$/g, '_');\n  },\n  toQueryString: function (obj) {\n    var s = '',\n        i = 0;\n    _.forOwn(obj, function (v, k) {\n      if (i) {\n        s += '&';\n      }\n      s += k + '=' + v;\n      i += 1;\n    });\n    return s;\n  },\n  createEvent: function (eventName, details) {\n    return new CustomEvent(eventName, {\n      detail: details\n    });\n  },\n  notification: function (message, consoleToo) {\n    var ev = utils.createEvent('pojoviz-notification', message);\n    consoleToo && console.log(message);\n    document.dispatchEvent(ev);\n  },\n  createJsonpCallback: function (url) {\n    var script = document.createElement('script');\n    script.src = url;\n    document.head.appendChild(script);\n  }\n};\n\nmodule.exports = utils;","var _ = require('lodash'),\n  d3 = (typeof window !== \"undefined\" ? window.d3 : typeof global !== \"undefined\" ? global.d3 : null),\n  utils = require('../../util/'),\n  pojoVizProperty = require('./Property'),\n  hashKey = require('../../util/hashKey');\n\nvar prefix = utils.prefixer;\nvar escapeCls = utils.escapeCls;\nvar margin = { top: 0, right: 0, left: 0, bottom: 0 };\n\nfunction Node(parent) {\n\n  function my(selection) {\n    // create\n    var enter = selection.enter();\n\n    function groupMouseBehavior(type) {\n      var over = type === 'over';\n      return function (d, i) {\n        var labelEscaped = escapeCls(d.label);\n\n        // hide all\n        parent.opacityToggle(over);\n\n        // select links\n        d3.selectAll('.' + prefix('to', labelEscaped))\n          .classed('selected predecessor', over);\n        d3.selectAll('.' + prefix('from', labelEscaped))\n          .classed('selected successor', over);\n\n        // select current node\n        d3.select('.' + prefix(labelEscaped))\n          .classed('selected current', over);\n\n        // select predecessor nodes\n        d.predecessors\n          .forEach(function (v) {\n            d3.selectAll('.' + prefix(escapeCls(v)))\n              .classed('selected predecessor', over);\n          });\n\n        // select successor nodes\n        d.successors\n          .forEach(function (v) {\n            d3.selectAll('.' + prefix(escapeCls(v)))\n              .classed('selected successor', over);\n          });\n      };\n    }\n\n    var nodeEnter = enter\n      .append('g')\n      .attr('class', function (d) {\n        var type = d.label\n          .match(/^(\\w)*/);\n        return [\n          prefix('node'),\n          prefix(type[0]),\n          prefix(escapeCls(d.label))\n        ].join(' ');\n      })\n      .attr('transform', function (d) {\n        return utils.translate(\n          d.x - d.width / 2,\n          d.y - d.height / 2\n        );\n      })\n      .on('mouseover', groupMouseBehavior('over'))\n      .on('mouseout', groupMouseBehavior('out'));\n\n    nodeEnter\n      .append('rect')\n      .attr('rx', 5)\n      .attr('ry', 5)\n      .attr('class', 'node-background');\n\n    nodeEnter\n      // .append('g')\n      .append('text')\n        .attr('class', prefix('title'))\n        .attr('transform', 'translate(20, 25)')\n        .text(function (d) {\n          var name = d.label\n            .match(/\\S*?-(.*)/)[1]\n            .replace('-', '.');\n          return name;\n        });\n\n    // nodeEnter\n    //   .append('text')\n    //     .attr('class', 'title')\n    //     .text(function (d) { return d.label; });\n\n    var bodyEnter = nodeEnter\n      .append('g')\n        .attr('class', prefix('body'));\n\n    var propertyCtor = pojoVizProperty();\n    propertyCtor.margin(margin);\n    bodyEnter.selectAll('g.' + prefix('property'))\n      .data(function (d) {\n        d.properties.forEach(function (p) {\n          p.label = d.label;\n        });\n        return d.properties;\n      })\n      .call(propertyCtor);\n\n    // fix node background width/height\n    selection.each(function (d, i) {\n      var el = d3.select(this),\n          rect = el.select('rect.node-background');\n\n      // setTimeout(function () {\n      var bbox = el.node().getBBox();\n      rect\n        .attr('width', bbox.width + 10 * 2)\n        .attr('height', bbox.height + 10);\n      // }, 0);\n    });\n  }\n  my.margin = function (m) {\n    if (!m) {\n      return margin;\n    }\n    margin = _.merge(margin, m);\n  };\n  return my;\n}\n\nmodule.exports = Node;","'use strict';\n\nvar _ = require('lodash'),\n  assert = require('./').assert,\n  me, hashKey;\n\nfunction isObjectOrFunction(v) {\n  return v && (typeof v === 'object' || typeof v === 'function');\n}\n\n/**\n * Gets a store hashkey only if it's an object\n * @param  {[type]} obj\n * @return {[type]}\n */\nfunction get(obj) {\n  assert(isObjectOrFunction(obj), 'obj must be an object|function');\n  return obj.hasOwnProperty &&\n    obj.hasOwnProperty(me.hiddenKey) &&\n    obj[me.hiddenKey];\n}\n\n/**\n * Sets a key on an object\n * @param {[type]} obj [description]\n * @param {[type]} key [description]\n */\nfunction set(obj, key) {\n  assert(isObjectOrFunction(obj), 'obj must be an object|function');\n  assert(\n    key && typeof key === 'string',\n    'The key needs to be a valid string'\n  );\n  if (!get(obj)) {\n    Object.defineProperty(obj, me.hiddenKey, {\n      value: typeof obj + '-' + key\n    });\n  }\n  return me;\n}\n\nme = hashKey = function (v) {\n  var value = v,\n      uid = v;\n\n  if (isObjectOrFunction(v)) {\n    if (!get(v)) {\n      me.createHashKeysFor(v);\n    }\n    uid = get(v);\n    if (!uid) {\n      console.err('no hashkey :(', v);\n    }\n    assert(uid, 'error getting the key');\n    return uid;\n  }\n\n  // v is a primitive\n  return typeof v + '-' + uid;\n};\nme.hiddenKey = '__pojoVizKey__';\n\nme.createHashKeysFor = function (obj, name) {\n\n  function localToString(obj) {\n    var match;\n    try {\n      match = {}.toString.call(obj).match(/^\\[object (\\S*?)\\]/);\n    } catch (e) {\n      match = false;\n    }\n    return match && match[1];\n  }\n\n  /**\n   * Analyze the internal property [[Class]] to guess the name\n   * of this object, e.g. [object Date], [object Math]\n   * Many object will give false positives (they will match [object Object])\n   * so let's consider Object as the name only if it's equal to\n   * Object.prototype\n   * @param  {Object}  obj\n   * @return {Boolean}\n   */\n  function hasAClassName(obj) {\n    var match = localToString(obj);\n    if (match === 'Object') {\n      return obj === Object.prototype && 'Object';\n    }\n    return match;\n  }\n\n  function getName(obj) {\n    var name, className;\n\n    // return the already generated hashKey\n    if (get(obj)) {\n      return get(obj);\n    }\n\n    // generate a new key based on\n    // - the name if it's a function\n    // - a unique id\n    name = typeof obj === 'function' &&\n      typeof obj.name === 'string' &&\n      obj.name;\n\n    className = hasAClassName(obj);\n    if (!name && className) {\n      name = className;\n    }\n\n    name = name || _.uniqueId();\n    return name;\n  }\n\n  // the name is equal to the passed name or the\n  // generated name\n  name = name || getName(obj);\n  name = name.replace(/[\\. ]/img, '-');\n\n  // if the obj is a prototype then try to analyze\n  // the constructor first so that the prototype becomes\n  // [name].prototype\n  // special case: object.constructor = object\n  if (obj.hasOwnProperty &&\n      obj.hasOwnProperty('constructor') &&\n      typeof obj.constructor === 'function' &&\n      obj.constructor !== obj) {\n    me.createHashKeysFor(obj.constructor);\n  }\n\n  // set name on self\n  set(obj, name);\n\n  // set name on the prototype\n  if (typeof obj === 'function' &&\n      obj.hasOwnProperty('prototype')) {\n    set(obj.prototype, name + '-prototype');\n  }\n};\n\nme.has = function (v) {\n  return v.hasOwnProperty &&\n    v.hasOwnProperty(me.hiddenKey);\n};\n\nmodule.exports = me;","var d3 = (typeof window !== \"undefined\" ? window.d3 : typeof global !== \"undefined\" ? global.d3 : null),\n  _ = require('lodash'),\n  utils = require('../../util/');\n\nvar prefix = utils.prefixer;\nvar escapeCls = utils.escapeCls;\nvar transformProperty = utils.transformProperty;\n\nfunction Property() {\n  var margin = {\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0\n  };\n\n  var titleHeight = 40;\n\n  function my(selection) {\n\n    function propertyY(d, i) {\n      return [\n        margin.left + 10,\n        margin.top + titleHeight + i * 15\n      ];\n    }\n\n    // PROPERTY CREATE\n    function mouseEvent(type) {\n      var over = type === 'over';\n      return function (d, i) {\n        d3.select(this)\n          .transition()\n            .duration(300)\n            .attr('transform', function () {\n              return utils.transform({\n                translate: propertyY(d, i),\n                scale: [over ? 1.5 : 1]\n              });\n            });\n      };\n    }\n    var propertyEnter = selection.enter()\n        .append('g')\n        .attr('class', function (d) {\n          return [\n            prefix('property'),\n            prefix(\n              escapeCls(transformProperty(d.name))\n            )\n          ].join(' ');\n        })\n        .attr('transform', function (d, i) {\n          return utils.transform({\n            translate: propertyY(d, i)\n          });\n        })\n        .on('mouseover', mouseEvent('over'))\n        .on('mouseout', mouseEvent('out'));\n\n    propertyEnter\n      .append('text')\n      .attr('font-size', 10)\n      .attr('text-anchor', 'start')\n      .attr('class', function (d) {\n        return [\n          prefix('key')\n        ].join(' ');\n      })\n      .text(function (d, i) {\n        return d.name;\n      })\n      .on('click', function (d, i) {\n        console.log(d);\n        var link = d.label.match(/\\S*?-([\\$\\w-\\.]*)/);\n        var ev = new CustomEvent('property-click', {\n          detail: {\n            name: link[1],\n            property: d.name\n          }\n        });\n        console.log(ev.detail);\n        document.dispatchEvent(ev);\n      });\n\n    var rectWrap = propertyEnter\n      .insert('rect', 'text')\n      .attr('class', function (d) {\n        return [\n          prefix(d.type),\n          prefix('property', 'background')\n        ].join(' ');\n      })\n      .attr('rx', 3)\n      .attr('ry', 3)\n      .attr('x', -2)\n      .attr('y', -9);\n\n    selection.selectAll('rect.' + prefix('property', 'background'))\n      .each(function (d) {\n        var me = d3.select(this)\n          .attr('height', function (d) {\n            var text = d3\n              .select(this.parentNode)\n              .select('text');\n            return text.property('clientHeight');\n          })\n          .attr('width', function (d) {\n            var text = d3\n              .select(this.parentNode)\n              .select('text');\n            return text.property('clientWidth') + 3;\n          });\n      });\n\n    propertyEnter.each(function (d) {\n      if (d.type === 'object' || d.type === 'function') {\n        d3.select(this)\n          .append('circle')\n          .attr('r', 4)\n          .attr('class', prefix('dot-' + d.type))\n          .attr('cx', -10)\n          .attr('cy', -2)\n          .attr('opacity', 1);\n      }\n    });\n  }\n  my.margin = function (m) {\n    if (!m) {\n      return margin;\n    }\n    margin = _.merge(margin, m);\n  };\n  return my;\n}\n\nmodule.exports = Property;"]}